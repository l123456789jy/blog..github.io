---
layout:     post
title:      "MTK平台GPS相关问题记录"
subtitle:   ""
date:       2022-04-02 16:42:00
author:     ""
header-img: "img/home-bg-o.jpg"
header-mask: 0.3
catalog:
tags: Android
    -
---
 

### GPS相关问题Log过滤关键
    
    - MTK GPS定位使用的是GPO辅助定位，过滤关键字‘EPO’代码位置在

          mediatek/proprietary/hardware/connectivity/gps/mtk_mnld/mnld_entity/src/epo.c
   
    

         mtk_gps_epo_file_time_hal: no EPO data yet
        行 15951: 03-19 15:57:12.211221   507   749 D         : mtk_epo_is_expired: EPO start time: 0, EPO start time: Thu Jan  1 08:00:00 1970
        行 15951: 03-19 15:57:12.211221   507   749 D         : mtk_epo_is_expired: EPO start time: 0, EPO start time: Thu Jan  1 08:00:00 1970
        行 15952: 03-19 15:57:12.211236   507   749 D         : mtk_epo_is_expired: EPO file is expired
        行 15957: 03-19 15:57:12.211460   507   736 D         : epo_file_download_impl: EPO MD5 not valid, download EPO_GR_3_1.MD5
        行 15957: 03-19 15:57:12.211460   507   736 D         : epo_file_download_impl: EPO MD5 not valid, download EPO_GR_3_1.MD5
        行 16412: 03-19 15:57:12.932037   507   736 D         : epo_MD5_download_process: EPO_GR_3_1.MD5 download success
        行 18004: 03-19 15:57:18.625632   507   736 D         : epo_DAT_download_process: EPO_GR_3_1.DAT download success
        行 18005: 03-19 15:57:18.626079   507   736 D         : epo_file_download_impl: EPO MD5 check success: 0
        行 18006: 03-19 15:57:18.626110   507   736 D         : epo_DAT_file_merge: first piece to merge, delete old EPOHAL.DAT
        行 18007: 03-19 15:57:18.626137   507   736 D         : epo_DAT_file_merge: merge /data/vendor/gps/EPO_GR_3_1.DAT file to EPOHAL.DAT
        行 18007: 03-19 15:57:18.626137   507   736 D         : epo_DAT_file_merge: merge /data/vendor/gps/EPO_GR_3_1.DAT file to EPOHAL.DAT

   

 

   #### 默认的缓存EPO的路径在`/data/vendor/gps/` 目录下面




   - 过滤相关日志 `MTK_GPS_MSG_FIX_READY` 来确定MTK是收到的GPS信号


     mtk_gps_sys_gps_mnl_callback: MTK_GPS_MSG_FIX_READY,GET_RTC_FAIL
     行 124612: 03-19 15:59:56.727362   507  6767 D         : mtk_gps_sys_gps_mnl_callback: MTK_GPS_MSG_FIX_READY, GET_RTC_OK, -22.070, 0.007
     行 125468: 03-19 15:59:57.737887   507  6767 D         : mtk_gps_sys_gps_mnl_callback: MTK_GPS_MSG_FIX_READY, GET_RTC_OK, -22.046, 0.009
     行 126269: 03-19 15:59:58.752500   507  6767 D         : mtk_gps_sys_gps_mnl_callback: MTK_GPS_MSG_FIX_READY, GET_RTC_OK, -21.968, 0.009
    
  



    （1）AGPS 只能下载两个小时的有效星历，MTK不使用此方式，所以代码中无需开启

        AGPS_SUPPORT这个宏；

    （2）EPO下载的数据为3天的辅助定位数，只要在有校时间不需要连网下载就可以进行AIDING,加速定位；

    （3）系统默认开机20秒后下载EPO文件。


  - 默认MTK平台GPS定位指标

    FULL start TTFF：小于50s。

    COLD start TTFF：小于40s。
    
    WARM start TTFF：小于35s。
    
    HOT start TTFF：小于5s。

    FULL start：没有任何的辅助资讯。相当于end user第一次买到手机后使用定位应用的场景。
    
    COLD start：有时间辅助资讯，end user不会遇到该场景。
    
    WARM start：有时间、位置辅助资讯，end user此次定位距离上次定位超过2～4个小时。
    
    HOT start：有所有的辅助资讯，end user此次定位距离上次定位小于2～4小时。
    
    所以对于end user经常会遇到的场景是WARM/HOT start。
      




